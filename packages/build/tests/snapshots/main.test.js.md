# Snapshot report for `packages/build/tests/main.test.js`

The actual snapshot is saved in `main.test.js.snap`.

Generated by [AVA](https://ava.li).

## --config

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 0 steps. Lets do this!␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## --config with an invalid path

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: 'invalid' }␊
    ␊
    ❯ Using config file: invalid␊
    ␊
    ␊
    ┌─────────────────────────────┐␊
    │    Netlify Build Error!     │␊
    └─────────────────────────────┘␊
    ␊
    Error: Netlify configuration error:␊
    Configuration file does not exist: invalid␊
    Cannot find module 'invalid' from 'internal'␊
    STACK TRACE␊
    `

## --help

> Snapshot 1

    `bin.js [OPTIONS...]␊
    ␊
    Run Netlify Build system locally.␊
    ␊
    Options can also be specified as environment variables prefixed with␊
    NETLIFY_BUILD_. For example the environment variable NETLIFY_BUILD_DRY=true can␊
    be used instead of the CLI flag --dry.␊
    ␊
    Options: --help     Show help                                                 [boolean]␊
      --version  Show version number                                       [boolean]␊
      --config   Path to the configuration file.␊
                 Defaults to any netlify.yml, netlify.toml, netlify.json or␊
                 netlify.js file in␊
                 the current directory or any parent directory              [string]␊
      --token    Netlify API token for authentication.␊
                 The NETLIFY_TOKEN environment variable can be used as well.[string]␊
      --context  Build context.␊
                 Default: 'production'                                      [string]␊
      --dry      Run in dry mode, i.e. printing commands without␊
                 executing them.␊
                 Default: false                                            [boolean]`

## Can define options as environment variables

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 0 steps. Lets do this!␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Can install local plugins

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌──────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from netlify-plugin-test   │␊
    └──────────────────────────────────────────────────────┘␊
    ␊
    test␊
    ␊
     ✔  netlify-plugin-test.init completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Can install plugins as Node modules

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from netlify-plugin-test␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌──────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from netlify-plugin-test   │␊
    └──────────────────────────────────────────────────────┘␊
    ␊
    test␊
    ␊
     ✔  netlify-plugin-test.init completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Can override plugins

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from netlify-plugin-example␊
      Loading plugin from /file/path␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ❯ OVERRIDE: "init" method in "netlify-plugin-example" has been overriden by "netlify-plugin-override"␊
    ┌──────────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from netlify-plugin-override   │␊
    └──────────────────────────────────────────────────────────┘␊
    ␊
    Overridden init␊
    ␊
     ✔  netlify-plugin-override.init completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Does not remove duplicate plugin options with different ids

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin "one" from /file/path␊
      Loading plugin "two" from /file/path␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 2 steps. Lets do this!␊
    ␊
    ┌──────────────────────────────────────┐␊
    │ 1. Running init lifecycle from one   │␊
    └──────────────────────────────────────┘␊
    ␊
    ␊
     ✔  one.init completed in 1ms␊
    ␊
    ┌──────────────────────────────────────┐␊
    │ 2. Running init lifecycle from two   │␊
    └──────────────────────────────────────┘␊
    ␊
    ␊
     ✔  two.init completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Empty configuration

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 0 steps. Lets do this!␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Functions: ignore package.json inside node_modules

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 3 steps. Lets do this!␊
    ␊
    ┌─────────────────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from @netlify/plugin-functions-core   │␊
    └─────────────────────────────────────────────────────────────────┘␊
    ␊
    ␊
     ✔  @netlify/plugin-functions-core.init completed in 1ms␊
    ␊
    ┌────────────────────────────────────────────────────────────────────┐␊
    │ 2. Running install lifecycle from @netlify/plugin-functions-core   │␊
    └────────────────────────────────────────────────────────────────────┘␊
    ␊
    ␊
     ✔  @netlify/plugin-functions-core.install completed in 1ms␊
    ␊
    ┌───────────────────────────────────────────────────────────────────────────┐␊
    │ 3. Running functionsBuild lifecycle from @netlify/plugin-functions-core   │␊
    └───────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Zipping functions␊
    Functions bundled in "/file/path": - test.zip␊
    ␊
     ✔  @netlify/plugin-functions-core.functionsBuild completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Functions: install dependencies nested

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 3 steps. Lets do this!␊
    ␊
    ┌─────────────────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from @netlify/plugin-functions-core   │␊
    └─────────────────────────────────────────────────────────────────┘␊
    ␊
    ␊
     ✔  @netlify/plugin-functions-core.init completed in 1ms␊
    ␊
    ┌────────────────────────────────────────────────────────────────────┐␊
    │ 2. Running install lifecycle from @netlify/plugin-functions-core   │␊
    └────────────────────────────────────────────────────────────────────┘␊
    ␊
    Installing functions dependencies␊
    added packages␊
    ␊
     ✔  @netlify/plugin-functions-core.install completed in 1ms␊
    ␊
    ┌───────────────────────────────────────────────────────────────────────────┐␊
    │ 3. Running functionsBuild lifecycle from @netlify/plugin-functions-core   │␊
    └───────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Zipping functions␊
    Functions bundled in "/file/path": ✔  @netlify/plugin-functions-core.functionsBuild completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Functions: install dependencies top-level

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 3 steps. Lets do this!␊
    ␊
    ┌─────────────────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from @netlify/plugin-functions-core   │␊
    └─────────────────────────────────────────────────────────────────┘␊
    ␊
    ␊
     ✔  @netlify/plugin-functions-core.init completed in 1ms␊
    ␊
    ┌────────────────────────────────────────────────────────────────────┐␊
    │ 2. Running install lifecycle from @netlify/plugin-functions-core   │␊
    └────────────────────────────────────────────────────────────────────┘␊
    ␊
    Installing functions dependencies␊
    added packages␊
    ␊
     ✔  @netlify/plugin-functions-core.install completed in 1ms␊
    ␊
    ┌───────────────────────────────────────────────────────────────────────────┐␊
    │ 3. Running functionsBuild lifecycle from @netlify/plugin-functions-core   │␊
    └───────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Zipping functions␊
    Functions bundled in "/file/path": - test.zip␊
    ␊
     ✔  @netlify/plugin-functions-core.functionsBuild completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Functions: invalid source directory

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 3 steps. Lets do this!␊
    ␊
    ┌─────────────────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from @netlify/plugin-functions-core   │␊
    └─────────────────────────────────────────────────────────────────┘␊
    ␊
    ␊
    Error: Functions directory "/file/path" not found␊
    STACK TRACE␊
    ␊
    Error in "init" step from "@netlify/plugin-functions-core"␊
    Command failed with exit code 1␊
    ␊
    ┌─────────────────────────────┐␊
    │    Netlify Build Error!     │␊
    └─────────────────────────────┘␊
    ␊
    In '@netlify/plugin-functions-core':␊
    Command failed with exit code 1␊
    ␊
    Error: Functions directory "/file/path" not found␊
    STACK TRACE␊
    `

## Functions: simple setup

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 3 steps. Lets do this!␊
    ␊
    ┌─────────────────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from @netlify/plugin-functions-core   │␊
    └─────────────────────────────────────────────────────────────────┘␊
    ␊
    ␊
     ✔  @netlify/plugin-functions-core.init completed in 1ms␊
    ␊
    ┌────────────────────────────────────────────────────────────────────┐␊
    │ 2. Running install lifecycle from @netlify/plugin-functions-core   │␊
    └────────────────────────────────────────────────────────────────────┘␊
    ␊
    ␊
     ✔  @netlify/plugin-functions-core.install completed in 1ms␊
    ␊
    ┌───────────────────────────────────────────────────────────────────────────┐␊
    │ 3. Running functionsBuild lifecycle from @netlify/plugin-functions-core   │␊
    └───────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Zipping functions␊
    Functions bundled in "/file/path": - test.zip␊
    ␊
     ✔  @netlify/plugin-functions-core.functionsBuild completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Install local plugin dependencies: already installed

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌──────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from netlify-plugin-test   │␊
    └──────────────────────────────────────────────────────┘␊
    ␊
    1.5␊
    ␊
     ✔  netlify-plugin-test.init completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Install local plugin dependencies: no package.json

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
    ␊
    Error: Error importing plugin:␊
    Cannot find module 'math-avg'␊
    STACK TRACE␊
    ␊
    ┌─────────────────────────────┐␊
    │    Netlify Build Error!     │␊
    └─────────────────────────────┘␊
    ␊
    Error loading "/file/path" plugin:␊
    Command failed with exit code 1␊
    ␊
    Error: Error importing plugin:␊
    Cannot find module 'math-avg'␊
    STACK TRACE␊
    `

## Install local plugin dependencies: propagate errors

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    npm ERR!␊
    ␊
    npm ERR!␊
    ␊
    ┌─────────────────────────────┐␊
    │    Netlify Build Error!     │␊
    └─────────────────────────────┘␊
    ␊
    Error: Error while installing dependencies in /file/path␊
    Command failed with exit code 1: npm install --no-progress --no-audit --no-package-lock␊
    STACK TRACE␊
    `

## Install local plugin dependencies: with npm

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    added packages␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌──────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from netlify-plugin-test   │␊
    └──────────────────────────────────────────────────────┘␊
    ␊
    1.5␊
    ␊
     ✔  netlify-plugin-test.init completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Install local plugin dependencies: with yarn

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    yarn install v1.0.0␊
    [1/4] Resolving packages...␊
    [2/4] Fetching packages...␊
    [3/4] Linking dependencies...␊
    [4/4] Building fresh packages...␊
    Done in 1ms.␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌──────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from netlify-plugin-test   │␊
    └──────────────────────────────────────────────────────┘␊
    ␊
    1.5␊
    ␊
     ✔  netlify-plugin-test.init completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Lifecycle commands can execute local binaries

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌────────────────────────────────────────────────────────────────────────────────────┐␊
    │ 1. Running build lifecycle from build.lifecycle.build in netlify.yml config file   │␊
    └────────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "atob dGVzdA=="␊
    test␊
    ␊
     ✔  build.lifecycle.build completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Plugin.id is optional

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌──────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from netlify-plugin-test   │␊
    └──────────────────────────────────────────────────────┘␊
    ␊
    test␊
    ␊
     ✔  netlify-plugin-test.init completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Plugins can execute local binaries

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌──────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from netlify-plugin-test   │␊
    └──────────────────────────────────────────────────────┘␊
    ␊
    test␊
    ␊
     ✔  netlify-plugin-test.init completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Print stack trace of lifecycle command errors

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌────────────────────────────────────────────────────────────────────────────────────┐␊
    │ 1. Running build lifecycle from build.lifecycle.build in netlify.yml config file   │␊
    └────────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "invalid"␊
    ␊
    /file/path 1: invalid: not found␊
    ␊
    Error in "build" step from "invalid"␊
    Command failed with exit code 127: invalid␊
    ␊
    ┌─────────────────────────────┐␊
    │    Netlify Build Error!     │␊
    └─────────────────────────────┘␊
    ␊
    In 'config.build.lifecycle.build':␊
    Command failed with exit code 127: invalid␊
    ␊
    /file/path 1: invalid: not found␊
    `

## Print stack trace of lifecycle command errors with stack traces

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌────────────────────────────────────────────────────────────────────────────────────┐␊
    │ 1. Running build lifecycle from build.lifecycle.build in netlify.yml config file   │␊
    └────────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "node build.js"␊
    ␊
    /file/path␊
    throw new Error('test')␊
    ^␊
    ␊
    Error: test␊
    STACK TRACE␊
    ␊
    Error in "build" step from "node build.js"␊
    Command failed with exit code 1: node build.js␊
    ␊
    ┌─────────────────────────────┐␊
    │    Netlify Build Error!     │␊
    └─────────────────────────────┘␊
    ␊
    In 'config.build.lifecycle.build':␊
    Command failed with exit code 1: node build.js␊
    ␊
    /file/path␊
    throw new Error('test')␊
    ^␊
    ␊
    Error: test␊
    STACK TRACE␊
    `

## Print stack trace of plugin errors

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌──────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from netlify-plugin-test   │␊
    └──────────────────────────────────────────────────────┘␊
    ␊
    ␊
    Error: test␊
    STACK TRACE␊
    ␊
    Error in "init" step from "netlify-plugin-test"␊
    Command failed with exit code 1␊
    ␊
    ┌─────────────────────────────┐␊
    │    Netlify Build Error!     │␊
    └─────────────────────────────┘␊
    ␊
    In 'netlify-plugin-test':␊
    Command failed with exit code 1␊
    ␊
    Error: test␊
    STACK TRACE␊
    `

## Print stack trace of validation errors

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ␊
    ┌─────────────────────────────┐␊
    │    Netlify Build Error!     │␊
    └─────────────────────────────┘␊
    ␊
    Error: Netlify configuration error:␊
    Configuration file does not exist: /file/path␊
    Cannot find module '/file/path' from 'internal'␊
    STACK TRACE␊
    `

## Redact secrets in build.lifecycle

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌────────────────────────────────────────────────────────────────────────────────────┐␊
    │ 1. Running build lifecycle from build.lifecycle.build in netlify.yml config file   │␊
    └────────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "echo [secure]"␊
    [secure]␊
    ␊
     ✔  build.lifecycle.build completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Redact secrets in plugins

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌──────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from netlify-plugin-test   │␊
    └──────────────────────────────────────────────────────┘␊
    ␊
    [secure]␊
    ␊
     ✔  netlify-plugin-test.init completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Remove duplicate plugin options

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
      Loading plugin from /file/path␊
      Loading plugin from /file/path␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌──────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from netlify-plugin-test   │␊
    └──────────────────────────────────────────────────────┘␊
    ␊
    ␊
     ✔  netlify-plugin-test.init completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Remove duplicate plugin options with different configs but same id

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
      Loading plugin from /file/path␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌──────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from netlify-plugin-test   │␊
    └──────────────────────────────────────────────────────┘␊
    ␊
    ␊
     ✔  netlify-plugin-test.init completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Reports missing plugins

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ┌─────────────────────────────┐␊
    │    Netlify Build Error!     │␊
    └─────────────────────────────┘␊
    ␊
    Error: 'does-not-exist' plugin not installed or found␊
    Cannot find module 'does-not-exist' from '/file/path'␊
    STACK TRACE␊
    `

## Smoke test

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
    No notices found on "@netlify/plugin-notifier" plugin configuration␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 4 steps. Lets do this!␊
    ␊
    ┌──────────────────────────────────────────────────────────────────────────────────┐␊
    │ 1. Running init lifecycle from build.lifecycle.init in netlify.yml config file   │␊
    └──────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "export VALUE=test"␊
    Running command "echo "$VALUE""␊
    ␊
    ␊
     ✔  build.lifecycle.init completed in 1ms␊
    ␊
    ┌──────────────────────────────────────────────────────────────────────────────────────────┐␊
    │ 2. Running getCache lifecycle from build.lifecycle.getCache in netlify.yml config file   │␊
    └──────────────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "echo 'curl custom cache'"␊
    curl custom cache␊
    ␊
     ✔  build.lifecycle.getCache completed in 1ms␊
    ␊
    ┌──────────────────────────────────────────────────────────────────────────────────────────┐␊
    │ 3. Running preBuild lifecycle from build.lifecycle.preBuild in netlify.yml config file   │␊
    └──────────────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "echo "shhhhhhh""␊
    shhhhhhh␊
    ␊
     ✔  build.lifecycle.preBuild completed in 1ms␊
    ␊
    ┌────────────────────────────────────────────────────────────────────────────────────┐␊
    │ 4. Running build lifecycle from build.lifecycle.build in netlify.yml config file   │␊
    └────────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "npm run build"␊
    ␊
    > smoke-test@1.0.0 build /file/path␊
    > echo build␊
    ␊
    build␊
    ␊
     ✔  build.lifecycle.build completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## Validate plugin.name is a string

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
    ␊
    Error: Property 'name' must be a string␊
    STACK TRACE␊
    ␊
    ┌─────────────────────────────┐␊
    │    Netlify Build Error!     │␊
    └─────────────────────────────┘␊
    ␊
    Error loading "/file/path" plugin:␊
    Command failed with exit code 1␊
    ␊
    Error: Property 'name' must be a string␊
    STACK TRACE␊
    `

## Validate plugin.name is required

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
      Loading plugin from /file/path␊
    ␊
    Attention beta testers!␊
    Please add the required "name" property to the object exported from the plugin.␊
    This is a new required field from plugins http://bit.ly/31z46mF␊
    ␊
    Example: module.exports = { name: 'my-plugin-name', init: () => {}, }␊
    Error: Missing required property 'name'␊
    STACK TRACE␊
    ␊
    ┌─────────────────────────────┐␊
    │    Netlify Build Error!     │␊
    └─────────────────────────────┘␊
    ␊
    Error loading "/file/path" plugin:␊
    Command failed with exit code 1␊
    ␊
    Attention beta testers!␊
    Please add the required "name" property to the object exported from the plugin.␊
    This is a new required field from plugins http://bit.ly/31z46mF␊
    ␊
    Example: module.exports = { name: 'my-plugin-name', init: () => {}, }␊
    Error: Missing required property 'name'␊
    STACK TRACE␊
    `

## {context:...}

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌────────────────────────────────────────────────────────────────────────────────────┐␊
    │ 1. Running build lifecycle from build.lifecycle.build in netlify.yml config file   │␊
    └────────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "echo prod"␊
    prod␊
    ␊
     ✔  build.lifecycle.build completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## {context:...} pointing to undefined path

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path', context: 'invalid' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    No config attribute found to satisfy the '${self:context.invalid.testProp}' variable. Attempting fallback value␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌────────────────────────────────────────────────────────────────────────────────────┐␊
    │ 1. Running build lifecycle from build.lifecycle.build in netlify.yml config file   │␊
    └────────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "echo {}"␊
    {}␊
    ␊
     ✔  build.lifecycle.build completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## {context:...} with --context

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path', context: 'development' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌────────────────────────────────────────────────────────────────────────────────────┐␊
    │ 1. Running build lifecycle from build.lifecycle.build in netlify.yml config file   │␊
    └────────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "echo dev"␊
    dev␊
    ␊
     ✔  build.lifecycle.build completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## {env:...}

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌────────────────────────────────────────────────────────────────────────────────────┐␊
    │ 1. Running build lifecycle from build.lifecycle.build in netlify.yml config file   │␊
    └────────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "echo test"␊
    test␊
    ␊
     ✔  build.lifecycle.build completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `

## {secrets:...}

> Snapshot 1

    `❯ Starting Netlify Build v1.0.0␊
      https://github.com/netlify/build␊
    ␊
    Options␊
      { config: '/file/path' }␊
    ␊
    ❯ Using config file: /file/path␊
    ␊
    ❯ Installing plugins dependencies␊
    ␊
    ❯ Loading plugins␊
      Loading plugin "@netlify/plugin-functions-core" from build core␊
    ␊
    ❯ Running Netlify Build Lifecycle␊
      Found 1 step. Lets do this!␊
    ␊
    ┌────────────────────────────────────────────────────────────────────────────────────┐␊
    │ 1. Running build lifecycle from build.lifecycle.build in netlify.yml config file   │␊
    └────────────────────────────────────────────────────────────────────────────────────┘␊
    ␊
    Running command "echo shhhhhhh"␊
    shhhhhhh␊
    ␊
     ✔  build.lifecycle.build completed in 1ms␊
    ␊
    ┌─────────────────────────────┐␊
    │   Netlify Build Complete!   │␊
    └─────────────────────────────┘␊
    ␊
     ✔  Netlify Build completed in 1ms␊
    ␊
    (ﾉ◕ヮ◕)ﾉ*:･ﾟ✧ Have a nice day!␊
    `
